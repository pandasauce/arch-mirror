[HEADER]
VERSION=4

[_EXTENSION]
TORQUE_MODE_EX=2
FIX_PROGRESSIVE_RATE=1
USE_DWB2=0
DAMPER_LUTS=1

;[ODE]                          ;optional - tuning these parameters can help with stability. See Open Dynamics Engine Manual (http://ode.org/wiki/index.php/Manual#Joint_error_and_the_Error_Reduction_Parameter_.28ERP.29) for more information.
;ERP=0.9                        ;this is the AC default for certain joint types, others (and global value) are 0.3
;CFM=1                          ;*10^-7 - just did this to keep numbers more reasonable

[BASIC]
WHEELBASE=2.565
;2.565 E30 M3
CG_LOCATION=0.570

[ARB]
EXTEND=1
FRONT_MOTION_RATIO=1.0
FRONT=66657
REAR_MOTION_RATIO=1.0
REAR=8310

;F ARB diameter = 19.0 - 22.0
;F ARB MR = 0.900^2 M3
;F ARB WIDTH	= 770 / 745
;F ARB LEVER	= 140 / 126
;F ARB DIAGONAL	= 203 (150) / 159 (135)

;R ARB diameter = 12.0 - 19.0
;R ARB MR = 0.570^2
;R ARB WIDTH	= 694 / 725
;R ARB LEVER	= 200 / 194 - 212, 2
;R ARB DIAGONAL	= 219 (205) / 212 - 230 (198 - 216), 2

[FRONT]
TYPE=COSMIC
BASEY=-0.240
TRACK=1.472
HUB_MASS=40
RIM_OFFSET=0.017 ;0.030, 0.027
;0.027 wheel
;0.010 spacer

;E30 M3 Front Drift Geo

;DJ0_POS_B, DJ1_POS_B = 0.000, -0.020, 0.000

;High
;STEER_JOINT_0_POS_A = 0.000, 0.000, +0.025
;STEER_JOINT_0_POS_B = +0.009, -0.020, -0.029

;Low
;STEER_JOINT_0_POS_A = 0.000, 0.000, +0.025
;STEER_JOINT_0_POS_B = +0.014, -0.020, -0.031

DJ0=F_E30_LCA_FRONT
DJ0_BODY_A=CHASSIS
DJ0_BODY_B=HUB_L
DJ0_POS_A=0.40996, -0.10443, -0.05313
DJ0_POS_B=0.08313, -0.15202, -0.00402

DJ1=F_E30_LCA_REAR
DJ1_BODY_A=CHASSIS
DJ1_BODY_B=HUB_L
DJ1_POS_A=0.41076, -0.09880, -0.35581
DJ1_POS_B=0.08313, -0.15202, -0.00402
DJ1_KP=0

STEER_JOINT_0=F_E30_TOE
STEER_JOINT_0_BODY_A=CHASSIS
STEER_JOINT_0_BODY_B=HUB_L
STEER_JOINT_0_POS_A=0.43169, -0.08431, 0.03944 ;Stock
STEER_JOINT_0_POS_A_1=0.43169, -0.08431, 0.06444 ;High
STEER_JOINT_0_POS_A_2=0.43169, -0.08431, 0.06444 ;Low

STEER_JOINT_0_POS_B=0.06944, -0.12948, 0.11350 ;Stock
STEER_JOINT_0_POS_B_1=0.07844, -0.12948, 0.08450 ;High
STEER_JOINT_0_POS_B_2=0.08344, -0.12948, 0.08250 ;Low

DJ2=F_E30_STRUT_TOP
DJ2_BODY_A=CHASSIS
DJ2_BODY_B=F_E30_STRUT_BODY
DJ2_POS_A=0.4366, 1.4236, -0.3622
DJ2_POS_B=0.23044, 0.47919, -0.10626

DJ3=F_E30_STRUT_CAMBER
DJ3_BODY_A=CHASSIS
DJ3_BODY_B=F_E30_STRUT_BODY
DJ3_POS_A=1.2074, 0.2659, -0.1063
DJ3_POS_B=0.23044, 0.47919, -0.10626

DJ4=F_E30_STRUT_CASTER
DJ4_BODY_A=CHASSIS
DJ4_BODY_B=F_E30_STRUT_BODY
DJ4_POS_A=0.2304, 0.7407, 0.8589
DJ4_POS_B=0.23044, 0.47919, -0.10626
DJ4_KP=1

;E30 M3 Front Sim Stuff

BODY_0_NAME=F_E30_STRUT_BODY
BODY_0_MASS=1
BODY_0_INERTIA=0.1, 0.1, 0.1
BODY_0_POS=0.23044, 0.47919, -0.10626
BODY_0_MIRROR=1

SLIDER_0=F_E30_STRUT_SLIDER
SLIDER_0_BODY_A=F_E30_STRUT_BODY
SLIDER_0_BODY_B=HUB_L
SLIDER_0_POS_A=0.23044, 0.47919, -0.10626
SLIDER_0_POS_B=0.11372, -0.05554, 0.03864
SLIDER_0_PARITY=-1

TOE_OUT=0.00000 ;-0.05
STATIC_CAMBER=-0.31 ;-3.00
STEER_JOINT_0_LENGTH_OFFSET=0.01811 ;Steer Toe
DJ3_LENGTH_OFFSET=-0.00701 ;Strut Camber
DJ0_LENGTH_OFFSET=0.02001 ;LCA F Camber
DJ1_LENGTH_OFFSET=0.02001 ;LCA R Camber
DJ4_LENGTH_OFFSET=0.01001 ;Strut Caster
;30L, Driver, Drift

[FRONT_COILOVER_0] ;CORNER SPRING + DAMPER
ELECT_LOG=CORNER
PULL_FORCE=0
PRELOAD_FORCE=0
PRELOAD=0.049 ;0.068, 0.049
;(Drift -0.020 @ wheel, -0.019 @ damper)

BODY_A=F_E30_STRUT_BODY
BODY_B=HUB_L
POS_A=0.23044, 0.47919, -0.10626
POS_B=0.11372, -0.05554, 0.03864

MIN_LENGTH=0.44717
MAX_LENGTH=0.60717
BUMPSTOP_GAP=0.071

;DAMPER_TRAVEL = 0.100, 0.060
;PACKER_HEIGHT = 0.050
;BUMPSTOP_GAP = 0.050 + 0.019 = 0.071
;DAMPER_LENGTH = 0.56617 - 0.019 = 0.54717

;Tuned 100/60 -20

INSTALL_RATE=1850000
RATE=58860
;6

[REAR]
TYPE=COSMIC
BASEY=-0.240
TRACK=1.484
HUB_MASS=42
RIM_OFFSET=0.017 ;0.030, 0.027
;0.027 wheel
;0.010 spacer

;E30 Rear Geo

J0=R_E30_STA_OUT
J0_BODY_A=R_E30_STA_OUT_JOINT
J0_BODY_B=HUB_L
J0_POS=0.19662, 0.02500, 0.39886

J1=R_E30_STA_IN
J1_BODY_A=R_E30_STA_IN_JOINT
J1_BODY_B=HUB_L
J1_POS=0.49317, 0.01700, 0.31879

;E30 Rear Adjusters

;TOE
BODY_0_NAME=R_E30_STA_OUT_JOINT
BODY_0_MASS=1
BODY_0_INERTIA=0.1, 0.1, 0.1
BODY_0_POS=0.19662, 0.02500, 0.39886
BODY_0_MIRROR=1

SLIDER_0=R_E30_STA_OUT_SLIDER
SLIDER_0_BODY_A=CHASSIS_REAR
SLIDER_0_BODY_B=R_E30_STA_OUT_JOINT
SLIDER_0_POS_A=0.19662, 0.02500, 0.29886
SLIDER_0_POS_B=0.19662, 0.02500, 0.39886
SLIDER_0_PARITY=-1

DJ0=R_E30_STA_OUT_ADJUSTER
DJ0_BODY_A=CHASSIS_REAR
DJ0_BODY_B=R_E30_STA_OUT_JOINT
DJ0_POS_A=0.19662, 0.02500, 0.29886
DJ0_POS_B=0.19662, 0.02500, 0.39886

;CAMBER
BODY_1_NAME=R_E30_STA_IN_JOINT
BODY_1_MASS=1
BODY_1_INERTIA=0.1, 0.1, 0.1
BODY_1_POS=0.49317, 0.01700, 0.31879
BODY_1_MIRROR=1

SLIDER_1=R_E30_STA_IN_SLIDER
SLIDER_1_BODY_A=CHASSIS_REAR
SLIDER_1_BODY_B=R_E30_STA_IN_JOINT
SLIDER_1_POS_A=0.49317, -0.08300, 0.31879
SLIDER_1_POS_B=0.49317, 0.01700, 0.31879
SLIDER_1_PARITY=-1

DJ1=R_E30_STA_IN_ADJUSTER
DJ1_BODY_A=CHASSIS_REAR
DJ1_BODY_B=R_E30_STA_IN_JOINT
DJ1_POS_A=0.49317, -0.08300, 0.31879
DJ1_POS_B=0.49317, 0.01700, 0.31879

;E30 Rear Sim Stuff

BODY_2_NAME=CHASSIS_REAR
BODY_2_MASS=489.34
;1308 - ((40 * 2) + (42 * 2) + (1 * 6)))  * (1 - 0.570)
BODY_2_INERTIA=1.179, 1.339, 4.349
BODY_2_CARPOS=0, 0, 0

HJ0=TORSION_HINGE
HJ0_BODY_A=CHASSIS
HJ0_BODY_B=CHASSIS_REAR
HJ0_CARPOS_A=0, 0, 1
HJ0_CARPOS_B=0, 0, -1

ENGINE_TORQUE_BODY=CHASSIS_REAR

TOE_OUT=-0.00000 ;+0.15
STATIC_CAMBER=-1.91 ;0.00
DJ1_LENGTH_OFFSET=0.01301 ;Inner Camber
DJ0_LENGTH_OFFSET=0.00061 ;Outer Toe
;30L, Driver, Drift

[REAR_COILOVER_0] ;CORNER SPRING
PULL_FORCE=0
PRELOAD_FORCE=0
PRELOAD=0.023 ;0.036, 0.023
;(Drift -0.020 @ wheel, -0.013 @ spring, -0.021 @ damper}

BODY_A=CHASSIS_REAR
BODY_B=HUB_L
POS_A=0.21589, 0.100, 0.10972
POS_B=0.21589, -0.050, 0.10972

MIN_LENGTH=0.070
MAX_LENGTH=1.000
BUMPSTOP_GAP=1.000

INSTALL_RATE=1850000
RATE=98100
;10

[REAR_COILOVER_1] ;CORNER DAMPER
ELECT_LOG=CORNER
BODY_A=CHASSIS_REAR
BODY_B=HUB_L
POS_A=0.24000, 0.42000, 0.02000
POS_B=0.18031, -0.03000, -0.07413

MIN_LENGTH=0.289388
MAX_LENGTH=0.469388
BUMPSTOP_GAP=0.091

;DAMPER_TRAVEL = 0.120, 0.060
;PACKER_HEIGHT = 0.050
;BUMPSTOP_GAP = 0.070 + 0.021 = 0.091
;DAMPER_LENGTH = 0.46360 - 0.021 = 0.40938

;Tuned 120/60 -20 (-21)

;Bumpstop integrated on damper

RATE=0

[REAR_TORSION_0] ;TORSION SPRING
RATE=9000
PRELOAD=0
HINGE=TORSION_HINGE
PARITY=0

[REAR_DAMPER_0] ;TORSION DAMPER
BODY_A=CHASSIS
BODY_B=CHASSIS_REAR
POS_A=0, 1, 0
POS_B=0, 0, 0

DAMP_BUMP=10000
DAMP_FAST_BUMP=10000
DAMP_FAST_BUMPTHRESHOLD=1
DAMP_REBOUND=10000
DAMP_FAST_REBOUND=10000
DAMP_FAST_REBOUNDTHRESHOLD=1
PARITY=0

[GRAPHICS_OFFSETS]
WHEEL_LF=-0.010
SUSP_LF=-0.010
WHEEL_RF=0.010
SUSP_RF=0.010
WHEEL_LR=-0.005
SUSP_LR=-0.005
WHEEL_RR=0.005
SUSP_RR=0.005

[DAMAGE]
MIN_VELOCITY=40
GAIN=0.0004
MAX_DAMAGE=0.05
DEBUG_LOG=1