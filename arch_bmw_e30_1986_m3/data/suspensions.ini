[HEADER]
VERSION=4

[_EXTENSION]
TORQUE_MODE_EX=2
FIX_PROGRESSIVE_RATE=1
USE_DWB2=0
DAMPER_LUTS=1

;[ODE]                          ;optional - tuning these parameters can help with stability. See Open Dynamics Engine Manual (http://ode.org/wiki/index.php/Manual#Joint_error_and_the_Error_Reduction_Parameter_.28ERP.29) for more information.
;ERP=0.9                        ;this is the AC default for certain joint types, others (and global value) are 0.3
;CFM=1                          ;*10^-7 - just did this to keep numbers more reasonable

[BASIC]
WHEELBASE=2.565
;2.565 E30 M3
CG_LOCATION=0.545
;Auto Motor Und Sport
;M3 1237kg, 52.2%
;With fuel?
;Driver 0.4% rearward

[ARB]
FRONT=40123
REAR=3360

;F ARB diameter = 19.0 OD M3
;F ARB MR = 0.900^2 M3
;F ARB WIDTH	= 770
;F ARB LEVER	= 140
;F ARB DIAGONAL	= 203 (150)

;R ARB diameter = 14.5 OD M3
;R ARB MR = 0.570^2
;R ARB WIDTH	= 694
;R ARB LEVER	= 200
;R ARB DIAGONAL	= 219 (205)

[FRONT]
TYPE=COSMIC
BASEY=-0.240
TRACK=1.472
;1.412 ET30
HUB_MASS=40
RIM_OFFSET=0.030 ;0.030, 0.027
;Steelies/caps ET35 316, 318i 1.405
;Basket weave ET30 iS models 1.415
;Something ET25 iS models , 1.425
;Basket weave ET30 M3 E30 1.412
;Basket weave ET27 Evo II, Evo III 1.418

;E30 M3 Front Geo

DJ0=F_E30_LCA_FRONT
DJ0_BODY_A=CHASSIS
DJ0_BODY_B=HUB_L
DJ0_POS_A=0.40996, -0.10443, -0.05313
DJ0_POS_B=0.08313, -0.13202, -0.00402
DJ0_KP=0

DJ1=F_E30_LCA_REAR
DJ1_BODY_A=CHASSIS
DJ1_BODY_B=HUB_L
DJ1_POS_A=0.41076, -0.09880, -0.35581
DJ1_POS_B=0.08313, -0.13202, -0.00402

STEER_JOINT_0=F_E30_TOE
STEER_JOINT_0_BODY_A=CHASSIS
STEER_JOINT_0_BODY_B=HUB_L
STEER_JOINT_0_POS_A=0.43169, -0.08431, 0.03944
STEER_JOINT_0_POS_B=0.06944, -0.10948, 0.11350

J0=F_E30_STRUT_TOP
J0_BODY_A=CHASSIS
J0_BODY_B=F_E30_STRUT_BODY
J0_POS=0.23044, 0.47919, -0.10626
J0_KP=1

;E30 M3 Front Sim Stuff

BODY_0_NAME=F_E30_STRUT_BODY
BODY_0_MASS=1
BODY_0_INERTIA=0.1, 0.1, 0.1
BODY_0_POS=0.23044, 0.47919, -0.10626
BODY_0_MIRROR=1

SLIDER_0=F_E30_STRUT_SLIDER
SLIDER_0_BODY_A=F_E30_STRUT_BODY
SLIDER_0_BODY_B=HUB_L
SLIDER_0_POS_A=0.23044, 0.47919, -0.10626
SLIDER_0_POS_B=0.11372, -0.05554, 0.03864
SLIDER_0_PARITY=-1

TOE_OUT=0.00000 ;+0.14
STATIC_CAMBER=-0.31 ;-0.70
STEER_JOINT_0_LENGTH_OFFSET=-0.00031 ;Steer Toe
;70L, Driver, M3

;Normallage definition
;68kg*2 on front seats, 68kg on rear seat
;21kg in trunk, full fueltank
;Geometry at Normallage @ Design

[FRONT_COILOVER_0] ;CORNER SPRING + DAMPER
ELECT_LOG=CORNER
PULL_FORCE=0
PRELOAD_FORCE=3110
PRELOAD=0.001
;(M3 -0.015 @ wheel -0.016 @ damper)
;(Fuel -0.003 @ wheel)
;(Driver +7kg -0.001 @ wheel)
;-0.019 @ wheel, -0.020 @ damper
;Normallage  +0.020 @ wheel
;+0.001 @ wheel +0.001 @ damper TOTAL

BODY_A=F_E30_STRUT_BODY
BODY_B=HUB_L
POS_A=0.23044, 0.47919, -0.10626
POS_B=0.11372, -0.05554, 0.03864

MIN_LENGTH=0.47517
MAX_LENGTH=0.64517
BUMPSTOP_GAP=0.039

;DAMPER_TRAVEL = 0.075, 0.095
;PACKER_HEIGHT = 0.052
;BUMPSTOP_GAP = 0.023 + 0.016 = 0.039
;DAMPER_LENGTH = 0.56617 - 0.016 = 0.55017

;M3 75/95 -15

;E30 M3 31-33-2-225-377 "Additional damper, front" H=0.052

INSTALL_RATE=1750000
RATE=19964
;19964 N/m 31-33-1-130-040 E30 M3 till 02.1987, without AC
;24517 N/m 31-33-1-130-043 E30 M3 till 02.1987, with AC
;24517 N/m 31-33-1-130-043 E30 M3 from 02.1987, without AC
;25952 N/m 31-33-1-130-046 E30 M3 from 02.1987, with AC
;26875 N/m 31-33-2-226-781 E30 M3 Sport Evolution

[FRONT_SPRING_0] ;BUSHING SPRING
BODY_A=CHASSIS
BODY_B=HUB_L
POS_A=0, 1, 0
POS_B=0, 0, 0
PRELOAD=0.001

RATE=1239
;F_E30_LCA_REAR 0.32763 m 133 Nm/rad 1239 N/m

[REAR]
TYPE=COSMIC
BASEY=-0.240
TRACK=1.484
;1.424 ET30
HUB_MASS=40
RIM_OFFSET=0.030 ;0.030, 0.027
;Steelies/caps ET35 316, 318i 1.399
;Basket weave ET30 iS models 1.409
;Something ET25 iS models 1.419
;Basket weave ET30 M3 E30 1.424
;Basket weave ET27 Evo II, Evo III 1.430

;E30 Rear Geo

;J0=R_E30_STA_OUT
;J0_BODY_A=R_E30_STA_OUT_JOINT
;J0_BODY_B=HUB_L
;J0_POS=0.19662, 0.02500, 0.39886

DJ0=R_E30_STA_OUT_0
DJ0_BODY_A=R_E30_STA_OUT_JOINT
DJ0_BODY_B=HUB_L
DJ0_POS_A=0.19662, 0.02500, 0.39886
DJ0_POS_B=0.49317, 0.21700, 0.31879

J0=R_E30_STA_IN
J0_BODY_A=CHASSIS
J0_BODY_B=HUB_L
J0_POS=0.49317, 0.01700, 0.31879

;E30 Rear Adjusters

;TOE
BODY_0_NAME=R_E30_STA_OUT_JOINT
BODY_0_MASS=1
BODY_0_INERTIA=0.1, 0.1, 0.1
BODY_0_POS=0.19662, 0.02500, 0.39886
BODY_0_MIRROR=1

SLIDER_0=R_E30_STA_OUT_SLIDER
SLIDER_0_BODY_A=CHASSIS
SLIDER_0_BODY_B=R_E30_STA_OUT_JOINT
SLIDER_0_POS_A=0.19662, 0.02500, 0.29886
SLIDER_0_POS_B=0.19662, 0.02500, 0.39886
SLIDER_0_PARITY=-1

DJ1=R_E30_STA_OUT_ADJUSTER
DJ1_BODY_A=CHASSIS
DJ1_BODY_B=R_E30_STA_OUT_JOINT
DJ1_POS_A=0.19662, 0.02500, 0.29886
DJ1_POS_B=0.19662, 0.02500, 0.39886

TOE_OUT=-0.00000 ;+0.22
STATIC_CAMBER=-1.91 ;-1.91
DJ1_LENGTH_OFFSET=0.00101 ;Outer Toe
;70L, Driver, M3

;Normallage definition
;68kg*2 on front seats, 68kg on rear seat
;21kg in trunk, full fueltank
;Geometry at Normallage @ Design

[REAR_COILOVER_0] ;CORNER SPRING
PULL_FORCE=0
PRELOAD_FORCE=4160
PRELOAD=0.020
;(M3 -0.017 @ wheel -0.012 @ spring -0.018 @ damper}
;(Fuel +0.014 @ wheel)
;(Driver +7kg -0.001 @ wheel)
;-0.004 @ wheel, -0.002 @ spring
;Normallage  +0.033 @ wheel
;+0.029 @ wheel +0.020 @ spring TOTAL

BODY_A=CHASSIS
BODY_B=HUB_L
POS_A=0.21589, 0.100, 0.10972
POS_B=0.21589, -0.050, 0.10972

MIN_LENGTH=0.070
MAX_LENGTH=1.000
BUMPSTOP_GAP=1.000

INSTALL_RATE=1750000
RATE=43688
;43688 N/m 33-53-9-061-510 USA, JPN E30 M3, till 02.1987
;54990 N/m 33-53-9-061-084 USA, JPN E30 M3 from 02.1987
;54990 N/m 33-53-9-061-084 EU E30 M3

[REAR_COILOVER_1] ;CORNER DAMPER
ELECT_LOG=CORNER
BODY_A=CHASSIS
BODY_B=HUB_L
POS_A=0.24000, 0.42000, 0.02000
POS_B=0.18031, -0.03000, -0.07413

MIN_LENGTH=0.36060
MAX_LENGTH=0.54560
BUMPSTOP_GAP=0.088

;DAMPER_TRAVEL = 0.085, 0.100
;PACKER_HEIGHT = 0.015
;BUMPSTOP_GAP = 0.070 + 0.018 = 0.088
;DAMPER_LENGTH = 0.46360 - 0.018 = 0.44560

;M3 85/100 -17 (-18)

;Standard "stop buffer" 33-52-1-125-078 H=0.015
;Special "stop buffer" 33-52-2-226-090 H=0.015
;Bumpstop integrated on damper

RATE=0

[REAR_SPRING_0] ;R_E30_STA_OUT_1 SPRING
BODY_A=R_E30_STA_OUT_JOINT
BODY_B=HUB_L
POS0=0.19662, 0.02500, 0.39886
POS1=0.03000, 0.00000, 0.00000

RATE=4000000
PULL_FORCE=1

[REAR_DAMPER_0] ;R_E30_STA_OUT_1 DAMPER
BODY_A=R_E30_STA_OUT_JOINT
BODY_B=HUB_L
POS0=0.19662, 0.02500, 0.39886
POS1=0.03000, 0.00000, 0.00000

DAMP_BUMP=4000
DAMP_FAST_BUMPTHRESHOLD=50
DAMP_REBOUND=4000
DAMP_FAST_REBOUNDTHRESHOLD=50

[REAR_SPRING_1] ;BUSHING SPRING
BODY_A=CHASSIS
BODY_B=HUB_L
POS_A=0, 1, 0
POS_B=0, 0, 0
PRELOAD=0.029

RATE=1591
;R_E30_STA_OUT 0.44539 m 133 Nm/rad 670 N/m
;R_E30_STA_IN 0.58748 m 133 Nm/rad 385 N/m
;REAR_COILOVER_0 0.49815 m 133 Nm/rad 536 N/m

[GRAPHICS_OFFSETS]
WHEEL_LF=-0.010
SUSP_LF=-0.010
WHEEL_RF=0.010
SUSP_RF=0.010
WHEEL_LR=-0.005
SUSP_LR=-0.005
WHEEL_RR=0.005
SUSP_RR=0.005

[DAMAGE]
MIN_VELOCITY=40
GAIN=0.0004
MAX_DAMAGE=0.05
DEBUG_LOG=1